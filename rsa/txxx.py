p=3
import math
import sympy
# for  i in range(20):
#     print(p,math.factorial(p-2)%p)
#     p=sympy.nextprime(p)
# exit()
x=1
y=0

def g(a,b):
    global x,y
    if not b:
        x=1
        y=0
        return a
    r=g(b,a%b)
    t=x
    x=y
    y=t-a//b*y
    return r

m=11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391760451
n=11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391661439

ans=1
nn=1
p=None
q=0
for i in range(n+1,m-1):
    if p is None:
        p=i
    q=i
    nn+=1
    ans=ans*i%m
print(sympy.nextprime(sympy.prevprime(m))-m)

c=g(m,ans)

print('check',y*ans%m)

p=sympy.nextprime(y%m)
print('p',p)

z=80096058210213458444437404275177554701604739094679033012396452382975889905967
for i in range(9):
    z=sympy.prevprime(z)

value = [z]
for i in range(1, 10):
    value.append(sympy.nextprime(value[i - 1]))
print("value[-1] = ", value[-1])
# value[-1] = 80096058210213458444437404275177554701604739094679033012396452382975889905967
n = 1
for i in range(10):
    n = n * value[i]

value_q = 5591130088089053683141520294620171646179623062803708281023766040254675625012293743465254007970358536660934858789388093688621793201658889399155357407224541324547522479617669812322262372851929223461622559971534394847970366311206823328200747893961649255426063204482192349202005330622561575868946656570678176047822163692259375233925446556338917358118222905050574458037965803154233167594946713038301249145097770337253930655681648299249481985768272321820718607757023350742647019762122572886601905212830744868048802864679734428398229280780215896045509020793530842541217790352661324630048261329493088812057300480085895399922301827190211956061083460036781018660201163819104150988531352228650991733072010425499238731811243310625701946882701082178190402011133439065106720309788819

phi=1
for i in value:
    phi*=i-1

e=65537
x=1
y=0
c=g(phi,e)

d=y%phi
print('check',e*d%phi)
q=pow(value_q,d,n)

value_q = pow(q, e, n)
print('value_q',value_q)
q=sympy.nextprime(q)

print('q',q,q.to_bytes(64,'little'))

phi=(p-1)*(q-1)
x=1
y=0
c=g(phi,e)
n=p*q
d=y%phi
print('check',1-d*e%phi)

c=110644875422336073350488613774418819991169603750711465190260581119043921549811353108399064284589038384540018965816137286856268590507418636799746759551009749004176545414118128330198437101472882906564195341277423007542422286760940374859966152871273887950174522820162832774361714668826122465471705166574184367478
ans=pow(c,d,n)


print('check',c-pow(ans,e,n))

b=ans.to_bytes(32,'big')
print(b)